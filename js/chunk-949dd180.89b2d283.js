(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-949dd180"],{5141:function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{key:e.goodsKey,staticClass:"goods-add"},[o("a-steps",{staticClass:"goods-steps",attrs:{current:e.current}},e._l(e.steps,(function(e){return o("a-step",{key:e.title,attrs:{title:e.title}})})),1),o("div",{staticClass:"steps-content"},[0==e.current?o("goods-detail",{attrs:{form:e.form},on:{next:e.next}}):1==e.current?o("goods-sale-detail",{attrs:{form:e.form},on:{submit:e.submit,prev:e.prev}}):e._e()],1)],1)},a=[],s=(o("d81d"),o("5530")),n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"goods-detail"},[o("a-form-model",{ref:"ruleForm",attrs:{"label-col":{span:5},"wrapper-col":{span:12},model:e.goodsForm,rules:e.rules},on:{submit:e.handleSubmit}},[o("a-form-model-item",{attrs:{prop:"title",label:"副标题"}},[o("a-input",{model:{value:e.goodsForm.title,callback:function(t){e.$set(e.goodsForm,"title",t)},expression:"goodsForm.title"}})],1),o("a-form-model-item",{attrs:{label:"商品描述",prop:"desc"}},[o("a-textarea",{attrs:{autoSize:{minRows:2,maxRows:6}},model:{value:e.goodsForm.desc,callback:function(t){e.$set(e.goodsForm,"desc",t)},expression:"goodsForm.desc"}})],1),o("a-form-model-item",{attrs:{label:"商品类目"}},[o("a-select",{attrs:{placeholder:"选择类目"},on:{change:e.changeCategory},model:{value:e.goodsForm.category,callback:function(t){e.$set(e.goodsForm,"category",t)},expression:"goodsForm.category"}},e._l(e.category,(function(t){return o("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1),o("a-select",{attrs:{placeholder:"选择所属子类目"},model:{value:e.goodsForm.c_item,callback:function(t){e.$set(e.goodsForm,"c_item",t)},expression:"goodsForm.c_item"}},e._l(e.c_items,(function(t){return o("a-select-option",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1),o("a-form-model-item",{attrs:{label:"商品标签",prop:"tags"}},[o("a-select",{attrs:{mode:"tags",placeholder:"选择标签"},on:{change:e.changeTags},model:{value:e.goodsForm.tags,callback:function(t){e.$set(e.goodsForm,"tags",t)},expression:"goodsForm.tags"}},e._l(e.tags,(function(t,r){return o("a-select-option",{key:r,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1),o("a-form-model-item",{attrs:{"wrapper-col":{span:12,offset:5}}},[o("a-button",{attrs:{type:"primary","html-type":"submit"}},[e._v("下一步")])],1)],1)],1)},i=[],c=(o("4160"),o("159b"),o("96cf"),o("1da1")),l=o("c405"),u={data:function(){return{tags:["包邮，最晚次日达"],c_items:[],category:[],rules:{title:[{required:!0,message:"请输入商品副标题"}],category:[{required:!0,message:"请选择商品所属商品类目",type:"number"}],tags:[{required:!0,message:"请选择商品所属标签",type:"array"}]},formLayout:"horizontal",goodsForm:{title:"",desc:"",category:null,tags:[],c_items:[]}}},props:["form"],created:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l["a"].getCategoryList().then((function(t){e.category=t.data}));case 2:console.log("created"),e.goodsForm=Object(s["a"])({},e.form);case 4:case"end":return t.stop()}}),t)})))()},methods:{handleSubmit:function(e){var t=this;e.preventDefault(),this.$refs.ruleForm.validate((function(e){return console.log(e),e?t.$emit("next",t.goodsForm):(console.log("error submit!!"),!1)}))},changeTags:function(){},changeCategory:function(e){var t=this;this.category.forEach((function(o){o.id===e&&(t.c_items=o.c_items)}))}}},m=u,d=o("2877"),f=Object(d["a"])(m,n,i,!1,null,null,null),p=f.exports,g=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"goods-sale-detail"},[o("a-form-model",{ref:"ruleForm",attrs:{model:e.goodsForm,"label-col":{span:5},"wrapper-col":{span:12},rules:e.rules},on:{submit:e.handleSubmit}},[o("a-form-model-item",{attrs:{label:"商品售价",prop:"price"}},[o("a-input",{model:{value:e.goodsForm.price,callback:function(t){e.$set(e.goodsForm,"price",t)},expression:"goodsForm.price"}})],1),o("a-form-model-item",{attrs:{label:"商品折扣价",prop:"price_off"}},[o("a-input",{model:{value:e.goodsForm.price_off,callback:function(t){e.$set(e.goodsForm,"price_off",t)},expression:"goodsForm.price_off"}})],1),o("a-form-model-item",{attrs:{label:"商品库存",prop:"inventory"}},[o("a-input",{model:{value:e.goodsForm.inventory,callback:function(t){e.$set(e.goodsForm,"inventory",t)},expression:"goodsForm.inventory"}})],1),o("a-form-model-item",{attrs:{label:"计量单位",prop:"unit"}},[o("a-input",{model:{value:e.goodsForm.unit,callback:function(t){e.$set(e.goodsForm,"unit",t)},expression:"goodsForm.unit"}})],1),o("a-form-model-item",{attrs:{label:"商品相册",prop:"images"}},[o("a-upload",{staticClass:"avatar-uploader",attrs:{name:"avatar",listType:"picture-card","file-list":e.fileList,action:"https://mallapi.duyiedu.com/upload/images?appkey=qqqqqq_1594362822817",remove:e.removeImage},on:{preview:e.handlePreview,change:e.handleChange},model:{value:e.goodsForm.images,callback:function(t){e.$set(e.goodsForm,"images",t)},expression:"goodsForm.images"}},[e.imageUrl?o("img",{attrs:{src:e.imageUrl,alt:"avatar"}}):o("div",[o("a-icon",{attrs:{type:e.loading?"loading":"plus"}}),o("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1)]),o("a-modal",{staticStyle:{display:"flex","justify-content":"center","align-items":"center"},attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[o("img",{staticStyle:{margin:"20px"},attrs:{alt:"example",src:e.previewImage}})])],1),o("a-form-model-item",{attrs:{"wrapper-col":{span:12,offset:5}}},[o("a-checkbox",{attrs:{checked:e.isPutaway},on:{change:e.handleStatusChange}},[e._v("是否上架")])],1),o("a-form-model-item",{attrs:{"wrapper-col":{span:12,offset:5}}},[o("a-button",{attrs:{type:"default"},on:{click:e.prev}},[e._v("上一页")]),o("a-button",{attrs:{type:"primary","html-type":"submit"}},[e._v("完成")])],1)],1)],1)},h=[];o("b0c0"),o("a9e3");function v(e,t){var o=new FileReader;o.addEventListener("load",(function(){return t(o.result)})),o.readAsDataURL(e)}var b={data:function(){return{imageUrl:"",loading:!1,previewVisible:!1,fileList:[],previewImage:"",goodsForm:this.form,rules:{price:[{required:!0,message:""}],price_off:[{required:!0,message:""}],inventory:[{required:!0,message:""}],unit:[{required:!0,message:""}],images:[{required:!0,message:""}]}}},computed:{isPutaway:{get:function(){return 1===this.form.status},set:function(e){this.form.status=Number(e)}}},props:["form"],created:function(){this.goodsForm=Object(s["a"])({},this.form),console.log(this.form),this.fileList=this.form.images.map((function(e,t){return{url:e,uid:t,name:e,status:"done"}}))},methods:{handleChange:function(e){var t=e.file,o=e.fileList;"uploading"!==t.status&&console.log(t),"done"===t.status?(this.$message.success("上传成功"),t.url=t.response.data.url,t.thumbUrl=t.response.data.thumbUrl,this.goodsForm.images.push(t.url)):this.fileList=o},handleSubmit:function(e){var t=this;e.preventDefault(),this.$refs.ruleForm.validate((function(e){return console.log(e),e?(t.goodsForm.images=t.fileList.map((function(e,t){return{url:e.response?e.response.data.url:e.url,uid:t,name:e.name,status:e.response?e.response.data.status:"done"}})),t.$emit("submit",t.goodsForm)):(console.log("error submit!!"),!1)}))},changeTags:function(e){this.goodsForm.setFieldsValue({tags:e})},handleStatusChange:function(e){this.isPutaway=e.target.checked},prev:function(){this.$emit("prev",this.goodsForm)},handlePreview:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(e.url||e.preview){o.next=4;break}return o.next=3,v(e.originFileObj);case 3:e.preview=o.sent;case 4:t.previewImage=e.url||e.preview,t.previewVisible=!0;case 6:case"end":return o.stop()}}),o)})))()},removeImage:function(e){console.log(e)},handleCancel:function(){this.previewVisible=!1}}},F=b,y=Object(d["a"])(F,g,h,!1,null,null,null),_=y.exports,w=o("4c79"),x={data:function(){return{current:0,form:{status:1},goodsKey:1,steps:[{title:"填写商品基本信息"},{title:"填写商品销售信息"}]}},watch:{$route:function(){this.goodsKey=1}},components:{GoodsDetail:p,GoodsSaleDetail:_},created:function(){var e=this,t=this.$router.currentRoute.params;t&&t.id&&(this.goodsKey=t.id,w["a"].getProductDetail(t.id).then((function(t){e.form=t})).catch((function(t){e.$message.error(t)})))},methods:{next:function(e){this.current++,this.form=Object.assign(this.form,e)},prev:function(e){this.form=Object.assign(this.form,e),console.log(this.form),this.current--},submit:function(e){var t=this;this.form=Object.assign(this.form,e);var o=this.$router.currentRoute.params,r=Object(s["a"])({},this.form,{images:this.form.images.map((function(e){return e.url}))});o&&o.id?w["a"].editProduct(r).then((function(){t.$message.success("修改成功"),t.$router.push({name:"goodsList"})})).catch((function(e){t.$message.error(e)})):w["a"].addProduce(r).then((function(){t.$message.success("新增成功"),t.$router.push({name:"goodsList"})})).catch((function(e){t.$message.error(e)}))}}},$=x,k=(o("9143"),o("ee07"),Object(d["a"])($,r,a,!1,null,"0193b4d6",null));t["default"]=k.exports},"633c":function(e,t,o){},7156:function(e,t,o){var r=o("861d"),a=o("d2bb");e.exports=function(e,t,o){var s,n;return a&&"function"==typeof(s=t.constructor)&&s!==o&&r(n=s.prototype)&&n!==o.prototype&&a(e,n),e}},9143:function(e,t,o){"use strict";var r=o("633c"),a=o.n(r);a.a},a9e3:function(e,t,o){"use strict";var r=o("83ab"),a=o("da84"),s=o("94ca"),n=o("6eeb"),i=o("5135"),c=o("c6b6"),l=o("7156"),u=o("c04e"),m=o("d039"),d=o("7c73"),f=o("241c").f,p=o("06cf").f,g=o("9bf2").f,h=o("58a8").trim,v="Number",b=a[v],F=b.prototype,y=c(d(F))==v,_=function(e){var t,o,r,a,s,n,i,c,l=u(e,!1);if("string"==typeof l&&l.length>2)if(l=h(l),t=l.charCodeAt(0),43===t||45===t){if(o=l.charCodeAt(2),88===o||120===o)return NaN}else if(48===t){switch(l.charCodeAt(1)){case 66:case 98:r=2,a=49;break;case 79:case 111:r=8,a=55;break;default:return+l}for(s=l.slice(2),n=s.length,i=0;i<n;i++)if(c=s.charCodeAt(i),c<48||c>a)return NaN;return parseInt(s,r)}return+l};if(s(v,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var w,x=function(e){var t=arguments.length<1?0:e,o=this;return o instanceof x&&(y?m((function(){F.valueOf.call(o)})):c(o)!=v)?l(new b(_(t)),o,x):_(t)},$=r?f(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),k=0;$.length>k;k++)i(b,w=$[k])&&!i(x,w)&&g(x,w,p(b,w));x.prototype=F,F.constructor=x,n(a,v,x)}},aea0:function(e,t,o){},ee07:function(e,t,o){"use strict";var r=o("aea0"),a=o.n(r);a.a}}]);
//# sourceMappingURL=chunk-949dd180.89b2d283.js.map